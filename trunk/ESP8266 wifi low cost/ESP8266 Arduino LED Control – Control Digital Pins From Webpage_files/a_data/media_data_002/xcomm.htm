<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;-moz-box-sizing:border-box;box-sizing:border-box}body{font-family:"Helvetica Neue",Helvetica,Helvetica,Arial,sans-serif}</style>
</head>
<body>
<script>require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("./utils.js"),d=a("./browser.js"),e=function(){return this instanceof e?void this.init():new e};e.prototype.init=function(){this.data={}},e.prototype.add=function(a,b,c,d){c=c===!0?!0:!1;var e={func:b,one:c,ctx:d};return this.data.hasOwnProperty(a)?this.data[a].push(e):this.data[a]=[e],this},e.prototype.on=function(a,b,c){return this.add(a,b,!1,c)},e.prototype.off=function(a,b){if(!this.data.hasOwnProperty(a))return this;var d=c.reduce(this.data[a],function(a,d){return c.isNone(b)||d.func!==b?c.isNone(b)?a:(a.push(d),a):a},[]);return 0===d.length?delete this.data[a]:this.data[a]=d,this},e.prototype.one=function(a,b,c){return this.add(a,b,!0,c)},e.prototype.get=function(a,b,c,d){this.one(a+".response",c,d),this.notify(a,b)},e.prototype.notify=function(){var a=Array.prototype.slice.call(arguments,0);if(0===a.length)return this;var b=a.splice(0,1)[0];if(!this.data.hasOwnProperty(b))return this;var e,f=[],g=[];return c.each(this.data[b],function(a){g.push(a),a.one===!1&&f.push(a)}),0===f.length?delete this.data[b]:this.data[b]=f,c.each(g,function(f){try{e=c.isNone(f.ctx)?this:f.ctx,f.func.apply(e,a)}catch(g){d.console.error(b,a,g)}},this),this},b.exports=e},{"./browser.js":3,"./utils.js":23}],2:[function(a,b){!function(){var c=a("./utils.js"),d=a("./browser.js"),e=a("./json.js"),f=a("conf"),g={};g.batch=function(a,b){var d=[],e=[];return c.each(a,function(a){e.push(a),e.length===b&&(d.push(e),e=[])}),0!==e.length&&d.push(e),d},g.random=function(a){return Math.floor(Math.random()*a)},g.safeCreateQuery=function(a){var b=c.map(a,function(a,b){return b+"="+("urls"===b?a:encodeURIComponent(a))});return b.sort(),b.join("&")},g.Keeper=function(a,b){this.init(a,b)},g.Keeper.prototype={init:function(a,b){this.urls=a,this.count=0,this.results={},this.callback=b},each:function(a){if(this.results[a.original_url]=a,this.count++,this.count===this.urls.length){var b=c.map(this.urls,function(a){return this.results[a]},this);this.callback(b)}return this}},g.ajax=function(a,b,c){var d=new XMLHttpRequest;if("withCredentials"in d)d.open("GET",a,!0),c===!0&&(d.withCredentials=!0),d.setRequestHeader("Accept","application/json"),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?b&&b(e.parse(d.responseText)):b&&b({type:"error"}))};else{if("undefined"==typeof XDomainRequest)return b({type:"error"}),!1;d=new XDomainRequest,d.open("GET",a),d.onload=function(){b&&b(e.parse(d.responseText))},d.onerror=function(){b({type:"error"})},d.onprogress=function(){}}d.send(null)},g.API=function(a){this.init(a)},g.API.prototype.init=function(a){c.isString(a)?this.key=a:c.isNone(a)||(this.key=a.key),this.key=this.key?this.key:f.EMB_API_KEY,this.protocol="https:"===window.location.protocol?"https:":"http:"},g.API.prototype._buildUrl=function(a,b){if(c.isNone(this.key))return null;var d=this.protocol+"//api-cdn-"+g.random(5)+".embed.ly/"+a;return b=b?b:{},b.key=this.key,d+"?"+g.safeCreateQuery(b)},g.API.prototype._data=function(a,b,e,f){if(d.console.log(a,b,e,f),c.isNone(f)&&c.isFunction(e)&&(f=e,e={}),c.isNone(f))return!1;if(c.isString(b)){e.url=b;var h=this._buildUrl(a,e);return g.ajax(h,function(a){a.url=b,f(a)}),!0}if(c.isArray(b)){if(0===b.length)return!1;var i=new g.Keeper(b,f),j=g.batch(b,10),k=function(a,b){return function(d){c.each(b,function(b,c){var e=d[c];e.original_url=b,a.each(e)})}};return c.each(j,function(b){e.urls=c.map(b,function(a){return encodeURIComponent(a)}).join(",");var d=this._buildUrl(a,e);g.ajax(d,k(i,b))},this),!0}return f({type:"error"}),!1},g.API.prototype.oembed=function(a,b,c){return this._data("1/oembed",a,b,c)},g.API.prototype.extract=function(a,b,c){return this._data("1/extract",a,b,c)},g.API.prototype.event=function(a,b){var c="api-"+g.random(10)+".embed.ly",d=this.protocol+"//"+c+"/1/e",e=d+"?"+g.safeCreateQuery(a);g.ajax(e,b)},g.APP=function(){},g.APP.prototype.orgs=function(a){var b=f.EMB_APP_API+"/api/stats";g.ajax(b,a,!0)},g.Media=function(){this.init()},g.Media.prototype.init=function(){this.base="https://t.embed.ly/1/analytics/media"},g.Media.prototype.of=function(a,b,d){c.assert(b.start,"start date needed"),c.assert(b.end,"end date needed"),c.assert(b.filter,"filter needed");var e=this.base+"/of/url/"+encodeURIComponent(a)+"/stats";e+="?"+g.safeCreateQuery(b),g.ajax(e,d)},g.Media.prototype.urls=function(a,b){c.assert(a.start,"start date needed"),c.assert(a.end,"end date needed"),c.assert(a.key,"key needed");var d=this.base+"/urls?"+g.safeCreateQuery(a);g.ajax(d,b)},g.Media.prototype.refs=function(a,b,d){c.assert(b.start,"start date needed"),c.assert(b.end,"end date needed"),c.assert(b.key,"key needed");var e=this.base+"/of/url/"+encodeURIComponent(a)+"/urls";e+="?"+g.safeCreateQuery(b),g.ajax(e,d)},g.Cards=function(){this.init()},g.Cards.prototype.init=function(){this.base="https://t.embed.ly/1/analytics/cards"},g.Cards.prototype.of=function(a,b,d){c.assert(b.start,"start date needed"),c.assert(b.end,"end date needed"),c.assert(b.filter,"filter needed");var e=this.base+"/of/url/"+encodeURIComponent(a)+"/stats";e+="?"+g.safeCreateQuery(b),g.ajax(e,d)},g.Cards.prototype.recommend=function(a,b){c.assert(a.source,"source needed"),c.assert(a.embed,"embed needed"),c.assert(a.key,"key needed");var d=this.base+"/recommend?"+g.safeCreateQuery(a);g.ajax(d,b)},g.Display=function(){},g.Display.prototype._buildUrl=function(a,b,d){var e={key:f.EMB_API_KEY,url:b},h=c.extend(e,c.isNone(d)?{}:d),i="://i-cdn.embed.ly/1/display"+("display"===a?"":"/"+a);return(f.EMB_HTTPS?"https":"http")+i+"?"+g.safeCreateQuery(h)},g.Display.prototype.display=function(a,b){return this._buildUrl("display",a,b)},g.Display.prototype.crop=function(a,b){return this._buildUrl("crop",a,b)},g.Display.prototype.resize=function(a,b){return this._buildUrl("resize",a,b)},g.api=function(a){return new g.API(a)},g.app=function(){return new g.APP},g.media=function(){return new g.Media},g.cards=function(){return new g.Cards},g.display=function(){return new g.Display},b.exports=g}()},{"./browser.js":3,"./json.js":7,"./utils.js":23,conf:"AqyHQT"}],3:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./urlparse.js"),f=a("conf"),g={};g.supports={_test:function(a){var b=["Webkit","Moz","O","ms","Khtml"],d=document.createElement("div"),e=a.charAt(0).toUpperCase()+a.substr(1),f=[a];c.each(b,function(a){f.push(a+e)});for(var g=0;g<f.length;g++)if(""===d.style[f[g]])return!0;return!1},postMessage:function(){return!!window.postMessage},boxShadow:function(){return g.supports._test("boxShadow")},borderRadius:function(){return g.supports._test("borderRadius")},touch:function(){return!!("ontouchstart"in window)},svg:function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},mediaQuery:function(){return!("undefined"==typeof window.matchMedia&&"undefined"==typeof window.msMatchMedia)},rgba:function(){var a=document.createElement("div"),b=a.style.color;try{a.style.color="rgba(1,5,13,0.44)"}catch(c){}return a.style.color!==b},cors:function(){if("undefined"==typeof XMLHttpRequest)return!1;var a=new XMLHttpRequest;return"withCredentials"in a?!0:"undefined"!=typeof XDomainRequest?!0:!1},flash:function(){if("undefined"!=typeof navigator.plugins&&0!==navigator.plugins.length)return!!navigator.plugins["Shockwave Flash"];try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(a){return!1}}},g.detect=function(){var a=function(a,b){b?d.addClass(document.body,a):d.addClass(document.body,"no-"+a)};a("touch",g.supports.touch()),a("boxshadow",g.supports.boxShadow()),a("borderradius",g.supports.borderRadius()),a("rgba",g.supports.rgba()),a("mediaquery",g.supports.mediaQuery())},g.console={_log:function(a,b){if(f.EMB_DEBUG&&!c.isNone(window.console)&&window.console)if(window.console[a].apply)window.console[a].apply(window.console,b);else{var d=Array.prototype.join.call(b,", ");window.console[a](d)}},log:function(){this._log("log",arguments)},error:function(){this._log("error",arguments)}},g.open=function(a,b,d,e,f,h){if(c.isNone(f)||c.isNone(h)){var i=g.window.center(d,e);f=i.top,h=i.left}var j=window.open(a,b,"scrollbars=no, resizable=1, width="+d+", height="+e+", top="+f+", left="+h);window.focus&&j.focus()},g.cookie={set:function(a,b,c,d){var e="";if(c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),e="; expires="+f.toGMTString()}document.cookie=a+"="+b+e+"; path=/"+(d?"; secure":"")},get:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},del:function(a){g.cookie.set(a,"",-1)}},g.window={innerHeight:function(){return c.isNone(window.innerHeight)?document.documentElement.clientHeight:window.innerHeight},innerWidth:function(){return c.isNone(window.innerWidth)?document.documentElement.clientWidth:window.innerWidth},scrollY:function(){return c.isNone(window.pageYOffset)?(document.documentElement||document.body.parentNode||document.body).scrollTop:window.pageYOffset},center:function(a,b){var c=void 0!==window.screenLeft?window.screenLeft:screen.left,d=void 0!==window.screenTop?window.screenTop:screen.top,e=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,f=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,g=e/2-a/2+c,h=f/2-b/2+d;return{left:g,top:h}}},g.location={hash:function(){var a=window.location.href.split("#");return 2===a.length?a[1]:""},params:function(){return c.extend({},e.parseQuery(document.location.search),e.parseQuery(g.location.hash()))}},g.mobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},g.isIE=function(){return/msie|trident/i.test(navigator.userAgent)},g.language=function(){return window.navigator.userLanguage||window.navigator.language},g.animateScroll=function(a,b){var c,e,f=g.window.scrollY(),h=a-f,i=(new Date).getTime(),j=!1;b=b?b:500;var k=Math.round(h/b*10),l=function(b){return b>a};0>k&&(l=function(b){return a>b});var m=function(){clearInterval(c),g.console.log("duration",(new Date).getTime()-i),d.detachEvent("scroll",e)};c=setInterval(function(){return f+=k,l(f)?(m(),!1):(window.scrollTo(0,f),void(j=!0))},10),e=function(){j&&f!==g.window.scrollY()&&m()},d.addEvent("scroll",e)},b.exports=g},{"./dom.js":5,"./urlparse.js":21,"./utils.js":23,conf:"AqyHQT"}],4:[function(a,b){var c={obj:function(a,b,c,d){if(void 0===b&&void 0===c)return a;var e={};return e[d[0]]=a,e[d[1]]=b,e[d[2]]=c,e},rgbToHsl:function(a,b,c){var d=this.obj(a,b,c,"rgb");a=d.r/255,b=d.g/255,c=d.b/255;var e,f,g=Math.max(a,b,c),h=Math.min(a,b,c),i=(g+h)/2;if(g===h)e=f=0;else{var j=g-h;switch(f=i>.5?j/(2-g-h):j/(g+h),g){case a:e=(b-c)/j+(c>b?6:0);break;case b:e=(c-a)/j+2;break;case c:e=(a-b)/j+4}e/=6}return this.obj(e,f,i,"hsl")},hslToRgb:function(a,b,c){var d=this.obj(a,b,c,"hsl");a=d.h,b=d.s,c=d.l;var e,f,g;if(0===b)e=f=g=c;else{var h=function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a},i=.5>c?c*(1+b):c+b-c*b,j=2*c-i;e=h(j,i,a+1/3),f=h(j,i,a),g=h(j,i,a-1/3)}return this.obj(Math.round(255*e),Math.round(255*f),Math.round(255*g),"rgb")},rgbToHex:function(a,b,c){var d=this.obj(a,b,c,"rgb");return"#"+((1<<24)+(d.r<<16)+(d.g<<8)+d.b).toString(16).slice(1)},hexToRgb:function(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},segment:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push(this.rgbToHsl(d[0],d[1],d[2]))}b.sort(function(a,b){return a.l-b.l});var e={};e.lightest=this.hslToRgb(b[b.length-1]),e.darkest=this.hslToRgb(b[0]);for(var f=!0,g=0;g<b.length;g++){var h=b[g];if(0!==h.s||0!==h.h){f=!1;break}}return f?e.colorful=e.darkest:(b.sort(function(a,b){return a.l+2*a.s+a.h/5-(b.l+2*b.s+b.h/5)}),e.colorful=this.hslToRgb(b[b.length-1])),e}};b.exports=c},{}],5:[function(a,b){var c=a("./utils.js"),d={};d.toArray=function(a){return c.map(a,function(a){return a})},d.all=function(a){var b=[];return document.querySelectorAll?d.toArray(document.querySelectorAll(a)):b},d.one=function(a,b){var c=d.all(a,b);return 0===c.length?null:c[0]},d.create=function(a,b,e,f){if(!a||!c.isString(a))return null;c.isString(b)&&c.isNone(e)&&(e=b,b={});var g;return g=f?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a),c.each(b,function(a,b){g.setAttribute(b,a)}),e&&d.text(g,e),g},d.set=function(a,b,e){if(!a||!c.isString(a))return null;c.isString(b)&&c.isNone(e)&&(e=b,b={});var f=d.one(a);return f?(c.each(b,function(a,b){f.setAttribute(b,a)}),c.isNone(e)||d.text(f,e),f):null},d.replace=function(a,b){c.assert(c.isElement(a),"replace requires an element to be replaced"),c.assert(c.isElement(b),"replace requires an element to replace with."),a.parentNode.replaceChild(b,a)},d.remove=function(a){return c.isElement(a)&&c.isElement(a.parentNode)?void a.parentNode.removeChild(a):!1},d.hide=function(a){return c.isString(a)&&(a=d.one(a)),c.isElement(a)&&(a.style.display="none"),a},d.show=function(a,b){return c.isString(a)&&(a=d.one(a)),c.isElement(a)&&(a.style.display=b?"inline-block":"block"),a},d.svg=function(a,b,c){return d.create(a,b,c,"http://www.w3.org/2000/svg")},d.children=function(a,b){return c.isElement(a)?c.reduce(a.childNodes,function(a,d){if(c.isElement(d)){if(!c.isNone(b))if(d.namespaceURI&&"http://www.w3.org/2000/svg"===d.namespaceURI){if(d.nodeName!==b)return a}else if(b.toUpperCase()!==d.nodeName)return a;a.push(d)}return a},[]):[]},d.child=function(a,b){var c=d.children(a,b);return 0!==c.length?c[0]:null},d.text=function(a,b){if(!a||!c.isElement(a))return null;if(c.isNone(b))return a.innerText||a.textContent;var d=void 0===a.textContent?"innerText":"textContent";a[d]=b},d.hasClass=function(a,b){if(c.isString(a)&&(a=d.one(a)),!c.isElement(a)||!c.isString(b)||!b)return!1;var e=a.getAttribute("class");return c.isNone(e)?!1:(" "+e+" ").indexOf(" "+b+" ")>-1?!0:!1},d.addClass=function(a,b){if(c.isString(a)&&(a=d.one(a)),!c.isElement(a)||!c.isString(b)||!b)return!1;if(d.hasClass(a,b))return!1;var e=a.getAttribute("class");if(c.isNone(e))return a.setAttribute("class",b),!0;var f=e.split(" "),g=[];return c.map(f,function(a){var b=c.trim(a);""!==b&&g.push(b)}),g.push(b),a.setAttribute("class",g.join(" ")),!0},d.removeClass=function(a,b){if(c.isString(a)&&(a=d.one(a)),!c.isElement(a)||!c.isString(b)||!b)return!1;var e=a.getAttribute("class");if(c.isNone(e))return!1;var f=!1,g=c.reduce(e.split(" "),function(a,d){var e=c.trim(d);return e?e===b?(f=!0,a):(a.push(e),a):a},[]);return a.setAttribute("class",g.join(" ")),f},d.data=function(a,b,d){c.assert(a&&c.isElement(a),"dom.data needs an element."),c.assert(b&&c.isString(b),"dom.data needs an attr.");var e=c.camelCase(b);return c.isNone(d)?c.isNone(a.dataset)?a.getAttribute("data-"+b):c.isNone(a.dataset[e])?null:a.dataset[e]:void(c.isNone(a.dataset)?a.setAttribute("data-"+b,d):a.dataset[e]=d)},d.attrize=function(a){return a&&c.isObject(a)?c.map(a,function(a,b){return b+'="'+a+'"'}).sort().join(" "):""},d.event=function(a){var b=c.extend({},a||window.event);return b.target||(b.target=b.srcElement||document),3===b.target.nodeType&&(b.target=b.target.parentNode),!a.metaKey&&a.ctrlKey&&(b.metaKey=b.ctrlKey),b.stop=function(){a.preventDefault?a.preventDefault():a.returnValue=!1},b.pageX||b.pageY||!b.clientX&&!b.clientY||(b.pageX=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b.pageY=b.clientY+document.body.scrollTop+document.documentElement.scrollTop),b},d.addEvent=function(a,b,d){c.isNone(a)||(a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent?a.attachEvent("on"+b,d):a["on"+b]=d)},d.detachEvent=function(a,b,d){c.isNone(a)||(a.removeEventListener?a.removeEventListener(b,d,!1):a.detachEvent?a.detachEvent("on"+b,d):a["on"+b]=null)},d.trigger=function(a,b){c.assert(c.contains(["click"],b),"Not a valid event");var d;a.dispatchEvent?(d=document.createEvent("MouseEvents"),d.initEvent(b,!0,!0),a.dispatchEvent(d,!0)):(d=document.createEventObject(),a.fireEvent("on"+b,d))},d.rect=function(a){try{return a.getBoundingClientRect()}catch(b){}return!1},b.exports=d},{"./utils.js":23}],6:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./colors.js"),f={};f.Graph=function(a,b,c){return this.init(a,b,c)},f.Graph.ATTRS=["load","view","hover","play","click"],f.Graph.COLORS=["#3A7990","#fc6608","#521836","#f13d2f"],f.Graph.defaults={height:100,group:"unique",barPadding:.75,marginBottom:15,marginLeft:25,trim:!1,interval:"hour"},f.max=function(a,b){var d;return c.reduce(a,function(a,e){return d=c.isNone(b)?e:c.get(e,b,0),a>d?a:d},0)},f.min=function(a,b){var d;return c.reduce(a,function(a,e){return d=c.isNone(b)?e:c.get(e,b),null===d?null:null===a?d:d>a?a:d},null)},f.sum=function(a,b){var d;return c.reduce(a,function(a,e){return d=c.isNone(b)?e:c.get(e,b,0),d?a+d:a},0)},f.splitter=function(a,b,c,d){c=c?c:1;var e=Math.floor(a*c/b),g=e.toString().length,h=Math.pow(5,g-1);e-=e%h,1>e&&(e=1);for(var i,j=[],k=1;b>=k;k++)i=e*k,a>i&&j.push(e*k);if(!d){var l=f.splitter(a,b-1,c,!0);if(l[l.length-1]>j[j.length-1])return l}return j},f.playtime=function(a,b){if(!a||!c.isNumber(a))return a;var d=["y","d","h","m","s"];b=c.isNone(b)?d.length:b;var e,f=31536e3,g=86400,h=3600,i=60,j=1,k=0,l=c.map([f,g,h,i,j],function(b){return e=Math.floor((a-k)/b),k+=e*b,e});return c.trim(c.reduce(l,function(a,b,c){return b?(a.push(b+d[c]),a):a},[]).slice(0,b).join(" "))},f.date=function(a){var b=parseInt(a.substr(0,4),10),c=parseInt(a.substr(4,2),10),d=parseInt(a.substr(6,2),10),e=parseInt(a.substr(8,2),10),f=parseInt(a.substr(10,2),10),g=new Date;return g.setFullYear(b),g.setMonth(c+1),g.setDate(d),g.setHours(e),g.setMinutes(f),g.setSeconds(0),g.setMilliseconds(0),g},f.localize=function(a){var b=f.date(a);b.setMinutes(b.getMinutes()-b.getTimezoneOffset());var c=function(a){return(10>a?"0":"")+a};return[b.getFullYear(),c(b.getMonth()-1),c(b.getDate()),c(b.getHours()),c(b.getMinutes())].join("")},f.hourFmt=function(a){var b=parseInt(a.substr(8,2),10),c=parseInt(a.substr(10,2),10);return 0===b?b=12:b>12&&(b-=12),10>c&&(c="0"+c),[b,c].join(":")},f.currentInterval=function(a){var b,c=f.date(a[0].time),d=f.date(a[1].time),e=(d-c)/1e3;return b=60===e?"minute":3600===e?"hour":"day"},f.merge=function(a){var b,d=["hover","load","play","progress","click","total"],e={actions:d,unique:d,media:["total"]},f=c.reduce(a,function(a,d){return c.each(e,function(e,f){c.each(e,function(e){b=c.get(d[f],e,0),a[f].hasOwnProperty(e)?a[f][e]+=b:a[f][e]=b})}),!a.media.duration&&d.media.duration&&(a.media.duration=d.media.duration),a},{actions:{},unique:{},media:{}});return f.media.total&&f.unique.play&&(f.media.average_playtime=Math.floor(f.media.total/f.unique.play)),f},f.normalize=function(a,b,d){var e=["minute","hour","day"];c.assert(c.contains(e,b),'Not a valid interval: "'+b+'"');var g=f.currentInterval(a);c.assert(c.indexOf(e,g)<=c.indexOf(e,b),"Cannot convert down an interval. i.e. hours to minutes");var h=function(a){return c.reduce(f.Graph.ATTRS,function(b,d){return b+c.get(a,d,0)},0)},i=[],j=!1;if(c.each(a,function(a){return a=c.extend({},a),a.time=f.localize(a.time),a.actions.total=h(a.actions),a.unique.total=h(a.unique),d&&!j&&0===a.actions.total&&0===a.unique.total?!0:(j=!0,a.media.total=c.get(a.media,"average_playtime",0)*c.get(a.unique,"play",0),void i.push(a))},this),g===b)return i;if("hour"===g&&"day"===b){var k,l={},m=[];c.each(i,function(a){k=a.time.substr(0,8)+"0000",c.contains(m,k)||m.push(k),l.hasOwnProperty(k)?l[k].push(a):l[k]=[a]});var n;return c.map(m,function(a){return n=f.merge(l[a]),n.time=a,n})}c.assert(!1,"Normalized failed.")},f.watched=function(a){return c.reduce(a,function(a,b){b=c.extend({},b);var d=c.get(b,"media.watched",[]);return c.isArray(d)&&0!==d.length?0===a.length?d.slice(0):a.length!==d.length?a:c.map(a,function(a,b){return a+d[b]}):a},[])},f.Graph.prototype.init=function(a,b,d){this.parent=a,this.options=c.extend({},f.Graph.defaults,d?d:{}),this.options.width=c.get(this.options,"width",a.offsetWidth),this.data=f.normalize(b,this.options.interval,this.options.trim)},f.Graph.prototype.entry=function(a){return"media"===this.options.group?a.media:"actions"===this.options.group?a.actions:a.unique},f.Graph.prototype.max=function(a){if(a=c.isNone(a)?"total":a,a=c.isArray(a)?a:[a],0===a.length)return 0;var b,d,e;return c.reduce(this.data,function(f,g){return d=this.entry(g),b="total"===a[0]?d.total:c.reduce(a,function(a,b){return e=c.get(this.entry(g),b,0),e+a},0,this),b>f?b:f},0,this)},f.Graph.prototype.xAxisTicks=function(){var a;return"day"===this.options.interval?c.reduce(this.data,function(b,d,e){return a=c.map([d.time.substr(4,2),d.time.substr(6,2)],function(a){return"0"===a.substr(0,1)?a.substr(1):a}).join("/"),b.push({value:e,text:a}),b},[]):"hour"===this.options.interval?c.reduce(this.data,function(b,d,e){return"0000"===d.time.substr(8)&&e>2&&(a=c.map([d.time.substr(4,2),d.time.substr(6,2)],function(a){return"0"===a.substr(0,1)?a.substr(1):a}).join("/"),b.push({value:e,text:a})),b},[]):"minute"===this.options.interval?c.reduce(this.data,function(a,b,c){return parseInt(b.time.substr(10,2),10)%10===0&&c>4&&a.push({value:c,text:f.hourFmt(b.time)}),a},[]):void 0},f.Graph.prototype.xAxis=function(a,b,e,f){var g=this.options.height,h=this.options.marginBottom;f=c.isNone(f)?this.barWidth():f,e=c.isNone(e)?this.xAxisTicks():e;var i,j;c.each(e,function(e){var k=c.isNone(e.buffer)?3*e.text.length:e.buffer;i=d.svg("text",{"class":"x-axis-text",x:b(e.value)+f/2-k,y:g}),d.text(i,e.text),a.appendChild(i),j=d.svg("line",{"class":"x-axis",x1:b(e.value)+f/2,y1:g-h+5,x2:b(e.value)+f/2,y2:g-h}),a.appendChild(j)})},f.Graph.prototype.yAxis=function(a,b,e){var g=this.options.height,h=this.options.width,i=this.options.marginBottom,j=this.options.marginLeft,k=this.max(e),l=[];l=0===k?[0]:f.splitter(k,3,.9);var m,n;c.each(l,function(c){m=d.svg("text",{"class":"y-axis-text",x:1,y:g-b(c)-i+3}),"media"===this.options.group?d.text(m,f.playtime(c,1)):d.text(m,c),a.appendChild(m),n=d.svg("line",{"class":"y-axis-line",x1:j,x2:h,y1:g-b(c)-i,y2:g-b(c)-i}),a.appendChild(n)},this)},f.Hover=function(a,b,c,d){this.init(a,b,c,d)},f.Hover.prototype.init=function(a,b,e,g){this.data=a,this.svg=e,this.wrapper=b,this.xaxis=[],this.rectangles={},this.options=g,this.props=f.Graph.ATTRS;var h=this.options.width,i=this.options.barPadding,j=this.data.length,k=this.options.marginLeft,l=(h-k-j*i)/j,m=function(a){return Math.floor((a-k)/(l+i))};d.addEvent(this.wrapper,"mousemove",c.bind(function(a){this.xaxis=this.xaxis.sort(function(a,b){return a-b});for(var b=d.event(a),e=this.wrapper.getBoundingClientRect(),f={top:b.pageY-e.top,left:b.pageX-e.left},g=f.left,h=m(g),i=[],j=h-3;h+3>j;j++)i.push(this.xaxis[j]);var k=c.reduce(i,function(a,b){return Math.abs(b-g)<Math.abs(a-g)?b:a},-1e3),l=this.rectangles[k];return l?void this.hovered(b,l,f):!1},this)),d.addEvent(this.wrapper,"mouseleave",c.bind(function(){this.clearHover()},this))},f.Hover.prototype.add=function(a,b,c,d){this.rectangles[d]={obj:a,entry:b,elems:c,x:d},this.xaxis.push(d)},f.Hover.prototype.clearHover=function(){c.each(d.all(".line-active"),function(a){d.remove(a)}),c.each(d.all(".graph-hover"),function(a){d.remove(a)})},f.Hover.prototype.hovered=function(a,b,e){this.clearHover();var g=(this.options.width-this.data.length*this.options.barPadding)/this.data.length,h=b.x+g/2;this.svg.appendChild(d.svg("line",{"class":"line-active",x1:h,x2:h,y1:0,y2:this.options.height-this.options.marginBottom,stroke:"#444","stroke-width":"1"}));var i=c.map([4,6,8],function(a){var c=b.obj.time.substr(a,2);return"0"===c.substr(0,1)?c.substr(1):c}),j=i[0]+"/"+i[1]+" at "+f.hourFmt(b.obj.time),k=d.create("div",{"class":"graph-hover"}),l=['<h4 class="graph-header">'+j+"</h4>"];"media"===this.options.group?l=l.concat(["<dl>","<dt>Playtime:</dt>","<dd>"+f.playtime(c.get(b.entry,"total","n/a"),2)+"</dd>","<dt>Duration:</dt>","<dd>"+f.playtime(c.get(b.entry,"duration","n/a"),2)+"</dd>","<dt>Average:</dt>","<dd>"+f.playtime(c.get(b.entry,"average_playtime","n/a"),2)+"</dd>","</dl>"]):(l.push("<dl>"),c.each(this.props,function(a){l.push("<dt>"+c.capitalize("load"===a?"view":a)+"s:</dt>"),l.push("<dd>"+c.get(b.entry,a,"0")+"</dd>")},this),l.push("</dl>")),k.innerHTML=l.join(" ");var m=this.wrapper.getBoundingClientRect(),n=e.top<50?50:e.top;n=n+50>m.height?m.height-50:n;var o=h+130>m.width?h-115:h+10;k.style.top=n-50+"px",k.style.left=o+"px",this.wrapper.appendChild(k)},f.Graph.prototype.barWidth=function(){var a=this.options.width,b=this.options.barPadding,c=this.data.length,d=this.options.marginLeft;return(a-d-c*b)/c},f.Graph.prototype.bar=function(a){c.isNone(a)||(a=c.isArray(a)?a:[a],c.each(a,function(a){c.assert(c.contains(["load","hover","view","play","click"],a),"Invalid prop")}));var b=this.options.width,e=this.options.height,g=this.max(a),h=this.options.barPadding,i=(this.data.length,this.options.marginBottom),j=this.options.marginLeft,k=this.barWidth(),l=function(a){return a*(k+h)+j},m=function(a){return 0===g?0:a*((e-i)/g)},n=d.create("div",{id:"graph","class":"graph-wrapper"});n.style.width=b+"px",n.style.height=e+"px";var o=d.svg("svg",{"class":"graph-svg",width:b,height:e});this.options.label!==!1&&(this.xAxis(o,l),this.yAxis(o,m,a));var p;p=this.options.label!==!1?new f.Hover(this.data,n,o,this.options):{add:function(){}};var q;return c.each(this.data,function(b,g){var h=this.entry(b);if(0===h.total)return p.add(b,h,[],l(g),e-i),!0;var j,n,r=0,s=[],t=function(a,b){return{"class":"rect-"+a,"data-prop":a,width:k,height:b,x:l(g),y:e-b-r-i}};"media"===this.options.group?s.push(t("playtime",m(h.total))):c.each(f.Graph.ATTRS,function(b){return c.isNone(a)||c.contains(a,b)?(j=c.get(h,b,0),0===j?!0:(n=m(j),s.push(t(b,n)),void(r+=n))):!0});var u=c.map(s,function(a){return q=d.svg("rect",a),o.appendChild(q),q});p.add(b,h,u,l(g),e-i)},this),n.appendChild(o),this.parent.appendChild(n),setTimeout(function(){d.addClass(n,"graph-show")},20),p},f.Graph.prototype.heat=function(){{var a=this.options.width,b=this.options.height,g=this.options.marginBottom,h=f.watched(this.data);f.sum(this.data,"unique.play")}if(0===h.length)return null;var i=f.max(h),j=(f.min(h),c.map(h,function(a){return Math.round(a/i*100)})),k=function(a){var b=function(a){return.6*(1-a/100)+.3},c=function(a){return(1-a/100)*(1/6)};return e.rgbToHex(e.hslToRgb(c(a),1,b(a)))},l=a/h.length,m=function(a){return a*l},n=function(a){return 0===i?0:a*((b-g)/100)},o=d.create("div",{id:"graph","class":"graph-wrapper graph-heat"});o.style.width=a+"px",o.style.height=b+"px";var p=d.svg("svg",{"class":"graph-svg",width:a,height:b}),q=[];c.each(j,function(a,c){q=d.svg("rect",{"class":"rect-heat",width:l,height:n(a),x:m(c),y:b-n(a)-g,fill:k(a)}),p.appendChild(q)});var r,s=f.max(this.data,"media.duration"),t=c.map(f.splitter(s,10),function(b){return r=b*(a/s),{value:r,text:f.playtime(b)}},this);return t.splice(0,0,{value:0,text:"0",buffer:0}),this.options.label!==!1&&this.xAxis(p,function(a){return a},t,0),o.appendChild(p),this.parent.appendChild(o),setTimeout(function(){d.addClass(o,"graph-show")},20),{wrapper:o,svg:p}},b.exports=f},{"./colors.js":4,"./dom.js":5,"./utils.js":23}],7:[function(a,b){var c=a("./browser.js");b.exports=function(a){function b(a){return 10>a?"0"+a:a}function c(a){return h.lastIndex=0,h.test(a)?'"'+a.replace(h,function(a){var b=i[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(a,e){var h,i,j,k,l,m=f,n=e[a];switch(n&&"[object Date]"===Object.prototype.toString.call(n)&&(n=isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null),typeof n){case"string":return c(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(f+=g,l=[],"[object Array]"===Object.prototype.toString.apply(n)){for(k=n.length,h=0;k>h;h+=1)l[h]=d(h,n)||"null";return j=0===l.length?"[]":f?"[\n"+f+l.join(",\n"+f)+"\n"+m+"]":"["+l.join(",")+"]",f=m,j}for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(j=d(i,n),j&&l.push(c(i)+(f?": ":":")+j));return j=0===l.length?"{}":f?"{\n"+f+l.join(",\n"+f)+"\n"+m+"}":"{"+l.join(",")+"}",f=m,j}}var e={};if(window.JSON&&JSON.parse&&JSON.stringify)return window.JSON;var f,g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return e.stringify=function(a,b){var c;if(f="",g="","number"==typeof b)for(c=0;b>c;c+=1)g+=" ";else"string"==typeof b&&(g=b);return d("",{"":a})},e.parse=function(){var b,c,d,e,f={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},g=function(c){a.console.error({name:"SyntaxError",message:c,at:b,text:d})},h=function(a){return a&&a!==c&&g("Expected '"+a+"' instead of '"+c+"'"),c=d.charAt(b),b+=1,c},i=function(){var a,b="";for("-"===c&&(b="-",h("-"));c>="0"&&"9">=c;)b+=c,h();if("."===c)for(b+=".";h()&&c>="0"&&"9">=c;)b+=c;if("e"===c||"E"===c)for(b+=c,h(),("-"===c||"+"===c)&&(b+=c,h());c>="0"&&"9">=c;)b+=c,h();return a=+b,isFinite(a)?a:void g("Bad number")},j=function(){var a,b,d,e="";if('"'===c)for(;h();){if('"'===c)return h(),e;if("\\"===c)if(h(),"u"===c){for(d=0,b=0;4>b&&(a=parseInt(h(),16),isFinite(a));b+=1)d=16*d+a;e+=String.fromCharCode(d)}else{if("string"!=typeof f[c])break;e+=f[c]}else e+=c}g("Bad string")},k=function(){for(;c&&" ">=c;)h()},l=function(){switch(c){case"t":return h("t"),h("r"),h("u"),h("e"),!0;case"f":return h("f"),h("a"),h("l"),h("s"),h("e"),!1;case"n":return h("n"),h("u"),h("l"),h("l"),null}g("Unexpected '"+c+"'")},m=function(){var a=[];if("["===c){if(h("["),k(),"]"===c)return h("]"),a;for(;c;){if(a.push(e()),k(),"]"===c)return h("]"),a;h(","),k()}}g("Bad array")},n=function(){var a,b={};if("{"===c){if(h("{"),k(),"}"===c)return h("}"),b;for(;c;){if(a=j(),k(),h(":"),Object.hasOwnProperty.call(b,a)&&g('Duplicate key "'+a+'"'),b[a]=e(),k(),"}"===c)return h("}"),b;h(","),k()}}g("Bad object")};return e=function(){switch(k(),c){case"{":return n();case"[":return m();case'"':return j();case"-":return i();default:return c>="0"&&"9">=c?i():l()}},function(a){var f;return d=a,b=0,c=" ",f=e(),k(),c&&g("Syntax error"),f}}(),e}(c)},{"./browser.js":3}],8:[function(a,b){var c=a("./utils.js"),d=function(){this.init()};d.prototype.init=function(){this.len=0,this.count=0,this.results={},this.finished=!1,this.started=!1},d.prototype.callback=function(){var a=this.len;return this.len++,c.bind(function(b){this.each(a,b)},this)},d.prototype.done=function(){if(!this.started)return!1;if(this.finished)return!0;if(this.count===this.len){this.finished=!0;for(var a=[],b=0;b<this.len;b++)a.push(this.results[b]);return this.func.call(this.ctx,a),!0}},d.prototype.each=function(a,b){this.results[a]=b,this.count++,this.done()},d.prototype.wait=function(a,b){this.func=a,this.ctx=b?b:null,this.started=!0,this.done()},b.exports=d},{"./utils.js":23}],9:[function(a,b){var c=a("./utils.js"),d={};d.intervals=[5,10,15,30],d.sequence=function(a){if(a.length<2)return[];for(var b,d,e,f=[],g=[],h=0;h<a.length;h++)if(d=a[h],c.isNone(b))f.push(d),b=d;else{if(e=d-b,e>2||-2>e?(g.push(f),f=[d]):f.push(d),h===a.length-1){g.push(f);break}b=d}var i,j,k=[];return c.each(g,function(a){a.length>2&&(i=Math.round(a[a.length-1]),j=Math.round(a[0]),k.push({start:j,end:i,duration:i-j}))
}),k},d.stringify=function(a){if(0===a.length)return null;var b=[];return c.each(a,function(a){!c.isNone(a)&&c.isNumber(a.start)&&c.isNumber(a.end)&&b.push(Math.round(a.start)+"-"+Math.round(a.end))}),0===b.length?null:b.join(",")},d.Progress=function(a,b){this.init(a,b)},d.Progress.prototype.init=function(a,b){this.started=!1,this.killed=!1,this._timeout=null,this.hub=a,this.type=b,this._interval=0,this._pace=1e3,this.times=[],this.last=null},d.Progress.prototype.nextInterval=function(){var a;return a=this._interval>=d.intervals.length-1?d.intervals[d.intervals.length-1]:d.intervals[this._interval],this._interval++,a},d.Progress.prototype.start=function(){return this.killed?!1:(this.started=!0,void(this._timeout=setTimeout(c.bind(function(){this.emit()},this),this.nextInterval()*this._pace)))},d.Progress.prototype.clear=function(){clearTimeout(this._timeout),this.started=!1,this.times=[]},d.Progress.prototype.kill=function(){this.clear(),this.killed=!0},d.Progress.prototype.emit=function(a){var b=this.times;this.times=[],a!==!1&&this.start();var c=d.sequence(b);if(0===c.length)return!1;if(c.length>1)return this.hub.notify(this.type+".progress.data",{times:c,duration:this.duration}),!0;var e=c[0];null!==this.last&&this.last.end&&Math.abs(e.start-this.last.end)<3&&(e.start=this.last.end),this.last=e,this.hub.notify(this.type+".progress.data",{times:[e],duration:this.duration})},d.Progress.prototype.delegate=function(a,b){c.each(this._listeners[a],c.bind(function(a){a.call(this,b)},this))},d.Progress.prototype.on=function(a,b){this._listeners.hasOwnProperty(a)?this._listeners[a].push(b):this._listeners[a]=[b]},d.Progress.prototype.timeupdate=function(a){if(this.killed)return!1;this.times.push(a.seconds);var b=c.isNone(a.duration)?null:Math.floor(a.duration);c.isNone(a.duration)||this.duration===b||(c.isNone(this.duration)?this.duration=b:this.kill()),this.started||this.start()},d.Progress.prototype.ended=function(){return this.killed?!1:void(this.duration&&this.duration>61&&(clearTimeout(this._timeout),this.emit(!1)))},d.Progress.prototype.update=function(a){return this.killed?!1:(this.times.push(a),void(this.started||this.start()))},d.media=function(a){var b=new d.Progress(a,"media");return a.on("media.timeupdate",function(a){b.timeupdate(a)}),a.on("media.ended",function(){b.ended()}),b},d.page=function(a,b,c){var e=new d.Progress(a,"page");b=b?b:1,c=c?c:1e3,e._pace=c;var f=0,g=function(a){e.update(a)};g(0);var h=setInterval(function(){f+=b,f>12e5&&(e.ended(),clearInterval(h)),g(f)},c);return a.on("page.progress.clear",function(){e.ended(),clearInterval(h)}),e},b.exports=d},{"./utils.js":23}],10:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./browser.js"),f=(a("./urlparse.js"),a("conf")),g=a("./json.js"),h={};h.connect=function(a){var b=e.location.params(),h=b.sid;return f.EMB_POST_MESSAGE?(a.on("window.message",function(b,d){return c.isNone(d.sid)||d.sid===h?(e.console.log("receiver.hub.notify",d.method,d),void a.notify(d.method,d)):!1}),d.addEvent(window,"message",function(b){if("__ready__"===b.data)return!1;var d;try{d=g.parse(b.data)}catch(e){return!1}return c.isNone(d)?!1:void a.notify("window.message",b,d)}),void a.on("receiver.send",function(a,b){if(window.self===window.top)return!1;c.isNone(b)&&(b={}),b.method=a,b.sid=h;var d=g.stringify(b);window.parent.postMessage(d,"*")})):!1},b.exports=h},{"./browser.js":3,"./dom.js":5,"./json.js":7,"./urlparse.js":21,"./utils.js":23,conf:"AqyHQT"}],11:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e=a("../graphs.js"),f=a("./init.js"),g={};g.html=['<div class="stats-actions clearfix">','<ul class="actions-tab actions-left inline-list">','<li><a href="#" class="stats-actions-group" data-group="unique" title="Unique Actions">Unique</a></li>','<li><a href="#" class="stats-actions-group" data-group="actions">Total</a></li>',"</ul>",'<ul class="actions-tab actions-right inline-list">','<li><a href="#" class="stats-actions-interval" data-interval="hour">Week</a></li>','<li><a href="#" class="stats-actions-interval" data-interval="minute">Realtime</a></li>',"</ul>","</div>",'<div class="stats-graph"></div>','<div class="stats-totals clearfix">','<ul class="totals-actions inline-list">','<li class="stats-totals-props" data-prop="load"><a href="#" class="totals-prop total-load">Visits</a><span></span></li>','<li class="stats-totals-props" data-prop="view"><a href="#" class="totals-prop total-view">Views</a><span></span></li>','<li class="stats-totals-props" data-prop="hover"><a href="#" class="totals-prop total-hover">Hovers</a><span></span></li>','<li class="stats-totals-props" data-prop="play"><a href="#" class="totals-prop total-play">Plays</a><span></span></li>','<li class="stats-totals-props" data-prop="click"><a href="#" class="totals-prop total-click">Click</a><span></span></li>',"</ul>","</div>"].join(""),g.title=['<a href="#" class="stats-back">&lt; Back</a>','<h4>Impressions | <span class="stats-range"></span></h4>'].join(""),g.graph=function(a,b){var g=d.one(".stats-graph");g.innerHTML="";var h=new e.Graph(g,a.data,b);h.bar(b.props);var i,j=a.totals;i="media"===f.group?["load","hover","play"]:c.get(j,"media.playtime")?["load","view","hover","play","click"]:["load","view","hover","click"],c.each(d.all(".stats-totals-props"),function(a){var e=d.child(a,"span"),g=d.data(a,"prop");d.text(e,f.comma(c.get(j,[b.group,g].join("."),0))),c.contains(i,g)?d.removeClass(a,"hide"):d.addClass(a,"hide")});var k;c.each(d.all(".stats-totals-props"),function(a){k=d.data(a,"prop"),c.get(j.unique,k)?d.removeClass(a,"hide"):d.addClass(a,"hide"),c.contains(b.props,k)?d.addClass(a,"active"):d.removeClass(a,"active")});var l;c.each(d.all(".stats-actions-group"),function(a){l=d.data(a,"group"),b.group===l?d.addClass(a.parentNode,"active"):d.removeClass(a.parentNode,"active"),"media"!==l||c.get(j.media,"playtime")?"media"===l&&d.removeClass(a.parentNode,"hide"):d.addClass(a.parentNode,"hide"),"heat"!==l||c.get(j.media,"heat")?"heat"===l&&d.removeClass(a.parentNode,"hide"):d.addClass(a.parentNode,"hide")}),c.each(d.all(".stats-actions-interval"),function(a){b.interval===d.data(a,"interval")?d.addClass(a.parentNode,"active"):d.removeClass(a.parentNode,"active")})},g.render=function(a,b){var e=d.one(".stats-block");e.innerHTML=g.html;var h=d.one(".stats-title");h.innerHTML=g.title,f.back(),b=c.extend({props:["load","view","hover","play","click"],group:"unique",interval:"hour",height:100},b?b:{}),g.graph(a,b),f.hub.off("window.resize"),f.hub.on("window.resize",function(){g.graph(a,b)}),d.set(".stats-range",a.range()),c.each(d.all(".totals-prop"),function(e){d.addEvent(e,"click",function(e){e=d.event(e),e.stop();var h=e.target.parentNode,i=d.data(h,"prop");d.hasClass(h,"active")?(d.removeClass(h,"active"),f.track("remove-prop",i)):(d.addClass(h,"active"),f.track("add-prop",i)),b.props=c.reduce(d.all(".stats-totals-props"),function(a,b){return d.hasClass(b,"active")&&a.push(d.data(b,"prop")),a},[]),g.graph(a,b)})}),c.each(d.all(".stats-actions-group"),function(c){d.addEvent(c,"click",function(c){c=d.event(c),c.stop();var e=c.target.parentNode,h=d.data(c.target,"group");return d.hasClass(e,"active")?!0:(f.track("change-group",h),b.group=h,void g.graph(a,b))})}),c.each(d.all(".stats-actions-interval"),function(a){d.addEvent(a,"click",function(a){a=d.event(a),a.stop(),f.hub.notify("stats.refresh.clear");var c=d.data(a.target,"interval");f.track("change-interval",c),"minute"===c?f.hub.notify("stats.bar.realtime",b):f.hub.notify("stats.bar.week",b)})}),"minute"===b.interval&&(f.hub.notify("stats.refresh.start"),f.hub.off("stats.refresh"),f.hub.on("stats.refresh",function(){f.hub.notify("stats.bar.realtime",b)}))},g.connect=function(a){a.on("stats.bar.render",g.render),a.on("stats.bar.realtime",function(b){a.get("stats.data.realtime",{},function(a){b=b?b:{},b.interval="minute",g.render(a,b)})}),a.on("stats.bar.week",function(b){a.get("stats.data.week",{},function(a){b=b?b:{},b.interval="hour",g.render(a,b)})})},b.exports=g},{"../dom.js":5,"../graphs.js":6,"../utils.js":23,"./init.js":16}],12:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e=a("../urlparse.js"),f=a("../keeper.js"),g=a("../browser.js"),h=a("../api.js"),i=(a("../graphs.js"),a("conf")),j=a("./init.js");a("./data.js"),a("./info.js");var k=a("./overview.js"),l=a("./bar.js"),m=a("./heatmap.js"),n=a("./refresh.js"),o=a("./loading.js");j.StatsContainer=function(a,b,c){this.init(a,b,c)},j.StatsContainer.prototype.init=function(a){this.hub=a,this.group=i.EMB_GROUP,this._data={}},j.StatsContainer.prototype.draw=function(){j.hover=!1;var a="stats-content"+(j.options.parent.offsetHeight<310?" stats-small":""),b="group-"+(c.isNone(this.group)?"card":this.group)+(j.options.inline?" stats-inline":"");this.wrapper=d.create("div",{id:"stats","class":b}),this.content=d.create("div",{"class":a}),j.options.parent.appendChild(this.wrapper),this.wrapper.appendChild(this.content),this.content.innerHTML=['<a href="#" class="stats-close">✕</a>','<div class="actions-refresh"></div>','<div class="stats-title"></div>','<div class="stats-byline"></div>','<div class="stats-block clearfix"></div>','<div class="stats-detail"></div>'].join(""),"card"!==this.group||j.options.inline||this.content.appendChild(d.create("div",{"class":"stats-triangle"}));var e=d.one(".stats-close");d.addEvent(e,"click",c.bind(function(a){var b=d.event(a);b.stop(),this.clear()},this)),this.byline(),this.details(),this.resize(),d.addEvent(window,"resize",c.bind(function(){this.resize()},this))},j.StatsContainer.prototype.resize=function(){var a=j.options.parent.offsetWidth,b=j.options.parent.offsetHeight;if(260>b?d.addClass(d.one(".stats-totals"),"disabled"):d.removeClass(d.one(".stats-totals"),"disabled"),(200>b||330>a)&&!j.options.inline){if(!d.one(".stats-error")){var c=d.create("div",{"class":"stats-error"});c.innerHTML=["<h4>The width and height of this Embed is too small for In-Embed analytics.</h4>",'<div class="stats-detail"></div>'].join(""),d.addClass(d.one(".stats-content"),"hide"),this.wrapper.appendChild(c),this.details()}}else{d.removeClass(d.one(".stats-content"),"hide");var e=d.one(".stats-error");e&&d.remove(e)}j.hub.notify("window.resize",{width:a,height:b})},j.StatsContainer.prototype.clear=function(){j.hover=!0,j.hub.notify("stats.refresh.clear"),d.remove(this.wrapper)},j.StatsContainer.prototype.byline=function(a){a=a?a:48;var b=d.one(".stats-byline"),c=j.options.url,e=j.options.filter;return e&&c&&(b.innerHTML=['<span>for: <a id="bylineURL" href="'+c+'" target="_blank" title="'+c+'">'+j.truncate(c,a)+"</a></span>",'<span>on: <a id="bylineRef" href="'+e+'" target="_blank" title="'+e+'">'+j.truncate(e,a)+"</a></span>"].join(""),j.track(d.one("#bylineURL"),"byline-url"),j.track(d.one("#bylineRef"),"byline-ref")),b},j.StatsContainer.prototype.details=function(a){return j.hub?void j.hub.get("xcomm.stats.access",{url:j.options.url,ref:j.options.filter,group:this.group},c.bind(function(b){if(b.access===!0){if(b&&b.url&&(b.org&&b.org.slug||b.s)){var f="https://app.embed.ly/organization/";f+="media"===a?[b.org&&b.org.slug?b.org.slug:"key/"+b.key,"analytics",j.format(j.offset(-6)),j.format(j.offset(1)),encodeURIComponent(b.url)].join("/"):[b.org&&b.org.slug?b.org.slug:"test-embedly","cards",b.org&&b.org.domain?b.org.domain:e.getDomain(b.url),encodeURIComponent(b.url),j.format(j.offset(-6)),j.format(j.offset(1))].join("/"),c.each(d.all(".stats-detail"),function(a){a.innerHTML='<a href="'+f+'" target="_blank">View in Dashboard<span>&nbsp;&gt;</span></a>'})}}else"media"===j.group&&(c.each(d.all(".stats-detail"),function(a){a.innerHTML=['<div class="stats-detail-left">','<a id="hideOverlay" href="https://cdn.embedly.com/widgets/options.html" target="_blank">disable</a>',"</div>",'<div class="stats-detail-right">','<a id="whatsThis" href="http://embed.ly/analytics/stats" target="_blank">What\'s this?</a>',"</div>"].join("")}),j.track(d.one("#hideOverlay"),"disable-overlay"),j.track(d.one("#whatsThis"),"whats-this"))},this)):!1},j._get=function(a,b,c,d,e){j.hub.get("xcomm.stats."+j.group+"."+a,b,function(a){var b=new j.StatsData(a.results,c,d);e.call(null,b)})},j.get=function(a,b,d,e){if(c.isNone(b)||""===document.referrer)return!1;var f=j.offset(-6),i=j.offset(1);c.assert(d.filter,"Need to set a filter");var k={start:j.format(f),end:j.format(i)};k=c.extend(k,d);var l="cards"===a?h.cards():h.media();l.of(b,k,c.bind(function(b){g.console.log(a+".of",b),e(b)},this))},j.recommend=function(a,b){if(c.isNone("cards"!==a.group))return!1;var d={source:e.getDomain(a.referrer),embed:a.url,key:"internal"},f=h.cards();f.recommend(d,b)},j.configure=function(a,b){return c.assert(null!==j.instance),a=c.extend({},a?a:{}),j.options=a,j.options.parent=a.parent?a.parent:document.body,j.group=b?b:j.instance.group,j.instance},j.connect=function(a,b,d){return c.assert(null===j.instance),j.hub=a,j.instance=new j.StatsContainer(a),b&&j.configure(b,d),a.on("stats.info.show",function(){j.info(a)}),a.on("stats.open",function(){j.hover=!1,j.instance.draw(),a.notify("track.event","stats","view","overlay"),a.notify("stats.open.response")}),a.on("stats.data.realtime",function(){var b=j.offset(0,-90),c=j.offset(0),d={url:j.options.url,filter:j.options.filter,realtime:!0,key:j.options.key};j._get("realtime",d,b,c,function(b){a.notify("stats.data.realtime.response",b)})}),a.on("stats.data.week",function(){var b=j.offset(-6),c=j.offset(1),d={url:j.options.url,filter:j.options.filter,start:j.format(b),end:j.format(c),key:j.options.key};j._get("week",d,b,c,function(b){a.notify("stats.data.week.response",b)})}),a.on("stats.data.overview",function(){var b=new f;a.get("stats.data.realtime",{},b.callback()),a.get("stats.data.week",{},b.callback()),b.wait(function(b){a.notify("stats.data.overview.response",b[0],b[1])})}),a.on("stats.close",function(){j.instance&&j.instance.clear()}),k.connect(a),l.connect(a),m.connect(a),n.connect(a),o.connect(a),j.instance},b.exports=j},{"../api.js":2,"../browser.js":3,"../dom.js":5,"../graphs.js":6,"../keeper.js":8,"../urlparse.js":21,"../utils.js":23,"./bar.js":11,"./data.js":13,"./heatmap.js":14,"./info.js":15,"./init.js":16,"./loading.js":17,"./overview.js":18,"./refresh.js":19,conf:"AqyHQT"}],13:[function(a){var b=a("./init.js"),c=a("../utils.js");b.StatsData=function(a,b,c){this.init(a,b,c)},b.StatsData.prototype.init=function(a,b,d){this.data=a,this.start=b,this.end=d,this.loads=0,this.views=0,this.hovers=0,this.clicks=0,this.plays=0,this.playtime=0,this.average_playtime=0,this.duration=0,this.totals={unique:{},actions:{},media:{playtime:0,heat:0}},c.each(this.data,function(a){if(c.every([a.media,a.actions,a.unique],c.isEmptyObject))return!0;var b;c.each(["unique","actions"],function(d){c.each(["load","view","hover","play","click"],function(e){b=c.get(a[d],e,0),this.totals[d].hasOwnProperty(e)?this.totals[d][e]+=b:this.totals[d][e]=b},this)},this),c.get(a.unique,"play")&&c.get(a.media,"average_playtime")&&(this.totals.media.playtime+=a.unique.play*a.media.average_playtime),c.get(a.media,"duration")&&(this.totals.media.duration=a.media.duration),c.get(a.media,"watched",[]).length>1&&(this.totals.media.heat+=1)},this),this.totals.unique.play&&this.totals.media.playtime&&(this.totals.media.average_playtime=Math.floor(this.totals.media.playtime/this.totals.unique.play))},b.StatsData.prototype.range=function(){var a=[this.start.getMonth()+1+"/"+this.start.getDate(),this.end.getMonth()+1+"/"+this.end.getDate()].join(" - ");return a}},{"../utils.js":23,"./init.js":16}],14:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e=a("../graphs.js"),f=a("./init.js"),g={};g.html=['<div class="stats-actions clearfix">','<ul class="actions-tab actions-right inline-list">','<li><a href="#" class="stats-actions-interval" data-interval="hour">Week</a></li>','<li><a href="#" class="stats-actions-interval" data-interval="minute">Realtime</a></li>',"</ul>","</div>",'<div class="stats-graph"></div>','<div class="stats-totals clearfix">','<ul class="totals-media inline-list">','<li><b>Plays</b><span class="stats-totals-play"></span></li>','<li><b>Average Playtime</b><span class="stats-totals-average"></span></li>','<li><b>Duration</b><span class="stats-totals-duration"></span></li>','<li><b>Total Playtime</b><span class="stats-totals-playtime"></span></li>',"</ul>","</div>"].join(""),g.title=['<a href="#" class="stats-back">&lt; Back</a>','<h4>Attention Heatmap | <span class="stats-range"></span></h4>'].join(""),g.graph=function(a,b){var g=d.one(".stats-graph");g.innerHTML="";var h=new e.Graph(g,a.data,b),i=a.totals;d.set(".stats-totals-play",f.comma(c.get(i,"unique.play",0)));var j=d.one(".stats-totals-average").parentNode;"minute"===b.interval?d.addClass(j,"hide"):(d.removeClass(j,"hide"),d.set(".stats-totals-average",e.playtime(c.get(i,"media.average_playtime",0),2))),d.set(".stats-totals-duration",e.playtime(c.get(i,"media.duration",0),2)),d.set(".stats-totals-playtime",e.playtime(c.get(i,"media.playtime",0),2)),h.heat(),c.each(d.all(".stats-actions-interval"),function(a){b.interval===d.data(a,"interval")?d.addClass(a.parentNode,"active"):d.removeClass(a.parentNode,"active")}),d.set(".stats-range",a.range())},g.render=function(a,b){var e=d.one(".stats-block");e.innerHTML=g.html;var h=d.one(".stats-title");h.innerHTML=g.title,f.back(),b=c.extend({interval:"hour",height:100},b?b:{}),g.graph(a,b),f.hub.off("window.resize"),f.hub.on("window.resize",function(){g.graph(a,b)}),c.each(d.all(".stats-actions-interval"),function(a){d.addEvent(a,"click",function(a){a=d.event(a),a.stop(),f.hub.notify("refresh.stop");var c=d.data(a.target,"interval");f.track("change-interval",c),"minute"===c?f.hub.notify("stats.heatmap.realtime",b):f.hub.notify("stats.heatmap.week",b)})})},g.connect=function(a){a.on("stats.heatmap.render",g.render),a.on("stats.heatmap.realtime",function(b){a.get("stats.data.realtime",{},function(a){b=b?b:{},b.interval="minute",g.render(a,b)})}),a.on("stats.heatmap.week",function(b){a.get("stats.data.week",{},function(a){b=b?b:{},b.interval="hour",g.render(a,b)})})},b.exports=g},{"../dom.js":5,"../graphs.js":6,"../utils.js":23,"./init.js":16}],15:[function(a){var b=a("./init.js"),c=a("../dom.js"),d=a("../browser.js");b.info=function(a){if(!d.supports.svg()||!d.supports.postMessage())return!1;var e;c.addEvent(document.body,"mouseenter",function(){if(b.hover===!1)return!1;var d=c.one("#statsInfo");null!==d&&c.remove(d);var f=document.body.offsetWidth,g=document.body.offsetHeight;if(200>g||330>f)return!1;e=c.create("a",{id:"statsInfo"}),document.body.appendChild(e),e.appendChild(c.create("i")),setTimeout(function(){e&&c.addClass(e,"stats-animate")},750),c.addEvent(e,"click",function(){c.remove(e),e=null,a.notify("stats.info.click")})}),c.addEvent(document.body,"mouseleave",function(){e&&c.remove(e)})}},{"../browser.js":3,"../dom.js":5,"./init.js":16}],16:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e={hover:!0,instance:null,hub:null,group:null};e.today=function(){var a=new Date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},e.offset=function(a,b){var d=e.today();return d.setDate(d.getDate()+a),c.isNone(b)||d.setMinutes(d.getMinutes()+b),d},e.format=function(a){return c.map([a.getFullYear(),a.getMonth()+1,a.getDate()],function(a){return 10>a?"0"+a.toString():a.toString()}).join("")},e.comma=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},e.truncate=function(a,b){if(c.isNone(a))return a;if(b=b?b:100,a=a.replace(/https?:\/\//,""),"www."===a.substr(0,4)&&(a=a.substr(4)),a.length<b)return a;var d=a.split("?");2===d.length&&(a=d[0]);for(var e,f=a.split("/"),g="",h=0;h<f.length;h++)if(e=f[h],0!==h){if(g.length+e.length+3>b){g+="/...";break}g+="/"+e}else g+=e;return g},e.track=function(a,b){e.hub&&(c.isElement(a)?e.hub.notify("track.click",a,"stats",b):e.hub.notify("track.event","stats",a,b))},e.percent=function(a){return(100*a).toFixed(2)+"%"},e.back=function(){d.addEvent(d.one(".stats-back"),"click",function(a){var b=d.event(a);b.stop(),e.hub.notify("stats.refresh.clear"),e.hub.notify("stats.overview")})},b.exports=e},{"../dom.js":5,"../utils.js":23}],17:[function(a,b){var c=a("../utils.js"),d=a("../dom.js"),e={};e.start=function(){var a=d.create("div",{"class":"stats-loading"}),b=d.one(".stats-block");b.innerHTML="",b.appendChild(a);for(var e=b.offsetWidth,f=50,g=d.svg("svg",{id:"loading",width:e,height:f}),h=10/3,i=e/h,j=[],k=0;i>k;k++)j.push(Math.floor(Math.random()*f));var l,m,n=function(a,b){var c=Math.random()>.5?1:-1;setInterval(function(){b+=c,0>=b?(c=1,b=0):b>f&&(c=-1),a.setAttribute("height",b),a.setAttribute("y",f-b)},20)};c.each(j,function(a,b){m=b*(h+1),l=d.svg("rect",{width:h,height:a,x:m,y:f-a}),g.appendChild(l),n(l,a)}),a.appendChild(g)},e.connect=function(a){a.on("stats.loading.start",function(){e.start()}),a.on("stats.loading.stop",function(){})},b.exports=e},{"../dom.js":5,"../utils.js":23}],18:[function(a,b){var c=(a("../utils.js"),a("../dom.js")),d=a("../graphs.js"),e=a("./init.js"),f={};f.engagement=['<div class="stats-divider">',"<hr>","<span>Realtime Engagement</span>","</div>",'<div class="stats-pane">','<div class="ui-block-1">','<h1 class="overview-engagement"></h1>',"<h2>Engagement</h2>",'<span class="overview-total-impressions"></span>',"</div>",'<div class="ui-block-2">','<div class="overview-impressions"></div>','<a class="overview-expand expand-bar" href="#">expand</a>',"</div>","</div>"].join(""),f.heatmap=['<div class="stats-divider">',"<hr>","<span>Attention Heatmap</span>","</div>",'<div class="stats-pane">','<div class="ui-block-1">','<h1 class="overview-attention"></h1>',"<h2>Attention Minutes</h2>","</div>",'<div class="ui-block-2">','<div class="overview-heatmap"></div>','<a class="overview-expand expand-heatmap" href="#">expand</a>',"</div>","</div>"].join(""),f.title=['<a href="http://embed.ly" class="stats-e" target="_blank"></a>','<h4>Analytics | <span class="stats-range"></span></h4>'].join(""),f.getData=function(a,b){var c;if(b.totals.unique.load&&a.totals.unique.load)c=b.totals.unique.load>a.totals.unique.load?b.totals.unique:a.totals.unique;else if(b.totals.unique.load)c=b.totals.unique;else{if(!a.totals.unique.load)return{load:0,hover:0,play:0};c=a.totals.unique}return{load:c.load?c.load:0,hover:c.hover?c.hover:0,play:c.play?c.play:0}},f.getEngagement=function(a,b){var c,d=f.getData(a,b);return c=d.load?d.play?d.play/d.load:d.hover/d.load:0,(100*c).toFixed(1)+"%"},f.graph=function(a,b){var e=c.one(".overview-impressions"),f=c.one(".overview-heatmap");if(e){e.innerHTML="";var g=b.totals.unique.play?["load","play"]:["load","hover"],h=new d.Graph(e,a.data,{interval:"minute",height:50,marginBottom:0,marginLeft:0,label:!1});h.bar(g)}if(f){f.innerHTML="";var i=new d.Graph(f,b.data,{interval:"hour",height:50,marginBottom:0,label:!1});i.heat()}},f.render=function(a,b){var d=c.one(".stats-title");d.innerHTML=f.title;var g=c.one(".stats-block"),h=b.totals,i=f.getData(a,b),j=f.engagement;h.media.heat&&(j+=f.heatmap),g.innerHTML=j;var k=f.getEngagement(a,b);c.text(c.one(".overview-engagement"),k),i.load&&c.text(c.one(".overview-total-impressions"),e.comma(i.load)+" impressions"),c.set(".stats-range",b.range()),f.graph(a,b);var l=c.one(".overview-heatmap"),m=c.one(".overview-impressions");c.addEvent(m,"click",function(){e.track("click","overview-bar"),e.hub.notify("stats.bar.render",a,{interval:"minute"})}),c.addEvent(l,"click",function(){e.track("click","overview-heatmap"),e.hub.notify("stats.heatmap.render",b)});var n=c.one(".overview-attention");c.text(n,e.comma(Math.round(h.media.playtime/60))),c.addEvent(c.one(".expand-bar"),"click",function(){e.track("click","expand-bar"),e.hub.notify("stats.bar.render",a,{interval:"minute"})}),c.addEvent(c.one(".expand-heatmap"),"click",function(){e.track("click","expand-heatmap"),e.hub.notify("stats.heatmap.render",b)}),e.hub.off("window.resize"),e.hub.on("window.resize",function(){f.graph(a,b)}),e.hub.notify("stats.overview.response",b)},f.connect=function(a){a.on("stats.overview.render",f.render),a.on("stats.overview",function(){a.get("stats.data.overview",{},function(a,b){f.render(a,b)})})},b.exports=f},{"../dom.js":5,"../graphs.js":6,"../utils.js":23,"./init.js":16}],19:[function(a,b){var c=(a("../utils.js"),a("../dom.js")),d=a("./init.js"),e={noCountdown:!1,countdownHover:!1,countdown:null,count:0};e.start=function(a){if(e.noCountdown===!0)return!1;var b,f=c.one(".actions-refresh"),g=!1;if(0===c.all(".stats-actions-refresh").length){var h=c.create("a",{href:"#","class":"stats-actions-refresh"},"Refresh");b=c.create("a",{href:"#","class":"stats-countdown"}),f.appendChild(h),f.appendChild(b),c.addEvent(b,"click",function(a){a=c.event(a),a.stop(),e.noCountdown=!0,clearInterval(e.countdown),c.text(b," "),d.track("cancel","countdown")}),c.addEvent(b,"mouseenter",function(){g=!0,c.text(b,"(−)"),c.addClass(b,"remove")}),c.addEvent(b,"mouseleave",function(){g=!1,c.removeClass(b,"remove"),e.noCountdown||c.text(b,"("+i+")")}),c.addEvent(h,"click",function(b){b=c.event(b),b.stop(),d.track("click","refresh"),clearInterval(e.countdown),a.notify("stats.refresh")}),c.removeClass(f,"hide")}else b=c.one(".stats-countdown");var i=30;e.count>5?(e.noCountdown=!0,c.text(b," ")):e.countdown=setInterval(function(){return i+=-1,0===i?(clearInterval(e.countdown),e.count+=1,c.text(b,"(0)"),a.notify("stats.refresh"),!0):void(g===!1&&c.text(b,"("+i+")"))},1e3)},e.connect=function(a){a.on("stats.refresh.clear",function(){a.off("stats.refresh");var b=c.one(".actions-refresh");b&&(b.innerHTML=""),e.count=0,clearInterval(e.countdown),e.countdown=null}),a.on("stats.refresh.start",function(){e.start(a)})},b.exports=e},{"../dom.js":5,"../utils.js":23,"./init.js":16}],20:[function(a,b){var c=a("./utils.js"),d=a("./dom.js"),e=a("./urlparse.js"),f=a("./browser.js"),g=a("./api.js"),h={instance:null};h.COOKIE_NAME="em_cdn_uid",h.Track=function(){this.init()},h.Track.prototype.init=function(){this.data={},this.group=null,this.ignore=!1,this.uid=this.getUID(),this.sid=c.getUUID(),this.canTrack=!0,f.supports.cors()||(this.canTrack=!1),this._api=g.api()},h.Track.prototype.getUID=function(){var a=f.cookie.get(h.COOKIE_NAME);if(c.isNone(a))return this.setUID();var b=e.parseQuery(decodeURIComponent(a));if(!b.u||!b.t)return this.setUID();var d;try{d=parseInt(b.t,10)}catch(g){return this.setUID()}return 32!==b.u.length?this.setUID():c.getTimestamp()-d>15552e6?this.setUID(b.u):b.u},h.Track.prototype.setUID=function(a){var b={u:c.isNone(a)?c.getUUID():a,t:c.getTimestamp()},d=encodeURIComponent(e.createQuery(b));return f.cookie.set(h.COOKIE_NAME,d,365),d=f.cookie.get(h.COOKIE_NAME),c.isNone(d)?0:(b=e.parseQuery(decodeURIComponent(d)),b.u)},h.Track.prototype.ga=function(a){if(f.console.log("Track.ga",a),!window.ga)return!1;var b=["click","play","pause","finish","shown"];if("button"===this.group&&"view"===a.a||"stats"===a.c);else if(!c.contains(b,a.a))return!1;var d=a.l;c.isNone(a.l)&&this.data.schema&&(d=this.data.schema),window.ga("send","event",a.c,a.a,d,{dimension1:a.r,dimension2:a.u})},h.Track.prototype.api=function(a){if(this.ignore===!0)return!1;var b=["view","play","finish","progress","click","hover","load","meta"];return c.contains(b,a.a)?"stats"===a.c?!1:(f.console.log("Track.api",a),void this._api.event(a,function(a){f.console.log("Track.api.logged",a)})):!1},h.Track.prototype.event=function(a,b,d,e){var f={uid:this.uid,sid:this.sid,u:this.data.url,r:this.referrer,g:this.group,t:c.getTimestamp(),c:a,a:b,l:d,key:this.data.key,s:this.data.schema};c.isNone(e)||(f=c.extend(f,e));var g={};c.each(f,function(a,b){c.isNone(a)||""===a||(g[b]=a)}),this.canTrack&&this.api(g),this.ga(g)},h.Track.prototype.click=function(a,b,e){d.addEvent(a,"click",c.bind(function(){this.event(b,"click",e)},this))},h.Track.prototype.hover=function(a,b){if(!c.isNone(a)){var e={elem:a,category:b,track:this,done:!1};d.addEvent(a,"mouseover",c.bind(function(){this.done===!1&&(this.done=!0,this.track.event(this.category,"hover"))},e))}},h.configure=function(a,b,d){return c.assert(null!==h.instance),h.instance.data=a,h.instance.group=b,h.instance.ignore=c.isNone(d)?!1:d,h.instance.referrer=a.referrer?a.referrer:document.referrer,c.isNone(h.instance.data.url)&&(h.instance.canTrack=!1),h.instance},h.connect=function(a){return c.assert(null===h.instance),h.instance=new h.Track,a.on("track.event",function(a,b,c,d){h.instance.event(a,b,c,d)}),a.on("track.click",function(a,b,c){h.instance.click(a,b,c)}),a.on("track.hover",function(a,b){h.instance.hover(a,b)}),h.instance},b.exports=h},{"./api.js":2,"./browser.js":3,"./dom.js":5,"./urlparse.js":21,"./utils.js":23}],21:[function(a,b){var c=a("./utils.js"),d={};d.createQuery=function(a){var b=[],d="";return a&&c.isObject(a)&&!c.isEmptyObject(a)?(c.each(a,function(a,c){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}),b.sort(),b.join("&")):d},d.parseQuery=function(a){var b={};if(!a||!c.isString(a))return b;("#"===a.substr(0,1)||"?"===a.substr(0,1))&&(a=a.substr(1));var d=a.split("&");return c.each(d,function(a){if(!a)return!0;var c=a.split("="),d=decodeURIComponent(c[0]);b[d]=1===c.length?"":decodeURIComponent(2===c.length?c[1]:c.slice(1).join("="))}),b},d.getQuery=function(a){if(!a||!c.isString(a))return{};var b=a.split("?");return 2===b.length?d.parseQuery(b[1]):b.length>2?d.parseQuery(b.slice(1).join("?")):{}},d.appendQuery=function(a,b){if(!a||!c.isString(a))return null;var e=a.split("?"),f=e[0];if(!b||!c.isObject(b)||c.isEmptyObject(b))return a;var g=d.getQuery(a);return g=c.extend(g,b),c.isEmptyObject(g)?a:[f,d.createQuery(g)].join("?")},d.removeQuery=function(a,b){if(!a||!c.isString(a))return null;var e=a.split("?"),f=e[0],g=d.getQuery(a);return g.hasOwnProperty(b)&&delete g[b],c.isEmptyObject(g)?f:[f,d.createQuery(g)].join("?")},d.getOrigin=function(a){if(!a||!c.isString(a))return null;if(!/^https?:\/\//.test(a))return null;var b=a.split("/").slice(0,3).join("/");return-1===b.indexOf(".")?null:b},d.getDomain=function(a){var b=d.getOrigin(a);return b?b.replace(/^https?:\/\//,""):null},d.Parsed=function(a,b){this.init(a,b)},d.Parsed.prototype.init=function(a,b){this.original=a,this.url=b,this._valid=!1,this.url=b},d.Parsed.prototype.valid=function(a){return(a===!0||a===!1)&&(this._valid=a),this._valid},d.parse=function(a){var b=a,e="https:"===window.location.protocol?"https:":"http:";a=a?c.trim(a):a;var f=new d.Parsed(b,a);return a?/^https?:\/\/[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f):/^\w+:/i.test(a)?f:"#"===a[0]?f:/^\/\/[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f.url=e+a,f):/^\/([^\/]+|$)/i.test(a)?(f.valid(!0),f.url=d.getOrigin(window.location.toString())+a,f):/^[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f.url="http://"+a,f):f:f},d.addHash=function(a,b){return-1===a.indexOf("#")?a+"#"+b:a+"&"+b},b.exports=d},{"./utils.js":23}],22:[function(a,b){var c=a("./utils.js"),d=a("./urlparse.js"),e=a("./browser.js"),f=a("conf"),g={};g.get=function(){var a=e.cookie.get("embly_u");if(c.isNone(a))return null;if(!window.atob)return null;var b;try{b=JSON.parse(window.atob(a))}catch(d){return e.console.log(d),null}return new g.User(b)},g.save=function(a){var b=new g.User(a);return b.save()},g.remove=function(){e.cookie.del("embly_u")},g.User=function(a){this.init(a)},g.User.prototype.init=function(a){this.orgs=a.orgs,this.s=a.s},g.User.prototype.data=function(){return{s:this.s?!0:!1,orgs:this.orgs}},g.User.prototype.orgByKey=function(a){if(this.orgs&&c.isArray(this.orgs))for(var b,d=0;d<this.orgs.length;d++)if(b=this.orgs[d],a===b.key||a===b.iframe_key)return b;return null},g.User.prototype.orgByUrls=function(a,b){var e=d.getDomain(b),f=d.getDomain(a);if(this.orgs&&c.isArray(this.orgs))for(var g,h,i=0;i<this.orgs.length;i++)if(g=this.orgs[i],g.cards&&c.isArray(g.cards))for(var j=0;j<g.cards.length;j++)if(h=g.cards[j],h===e||h===f)return g.domain=h,g;return null},g.User.prototype.save=function(){var a={};if(c.each(["orgs","s"],function(b){this.hasOwnProperty(b)&&this[b]&&(a[b]=this[b])},this),!window.atob)return!1;var b;try{b=window.btoa(JSON.stringify(a))}catch(d){return e.console.log(d),!1
}return e.cookie.set("embly_u",b,365,f.EMB_DEBUG===!1),!0},g.User.prototype.remove=function(){e.cookie.del("embly_u")},b.exports=g},{"./browser.js":3,"./urlparse.js":21,"./utils.js":23,conf:"AqyHQT"}],23:[function(a,b){var c=a("conf"),d={},e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=(f.push,f.slice),j=(f.concat,g.toString),k=f.forEach,l=(f.map,f.reduce),m=(f.reduceRight,f.filter,f.every),n=(f.some,f.indexOf),o=(f.lastIndexOf,Array.isArray,Object.keys,h.bind);d.identity=function(a){return a},d.each=function(a,b,c){if(null!=a)if(k&&a.forEach===k)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(d in a&&b.call(c,a[d],d,a)===e)return}else for(var h in a)if(g.hasOwnProperty.call(a,h)&&b.call(c,a[h],h,a)===e)return},d.map=function(a,b,c){var e=[];return null==a?e:Array.prototype.map&&a.map===Array.prototype.map?a.map(b,c):(d.each(a,function(a,d,f){e[e.length]=b.call(c,a,d,f)}),e)},d.reduce=function(a,b,c,e){var f=arguments.length>2;if(null==a&&(a=[]),l&&a.reduce===l)return e&&(b=d.bind(b,e)),f?a.reduce(b,c):a.reduce(b);if(d.each(a,function(a,d,g){f?c=b.call(e,c,a,d,g):(c=a,f=!0)}),!f)throw new TypeError("Reduce of empty array with no initial value");return c},d.zip=function(a){return d.map(a[0],function(b,c){return b.map(a,function(a){return a[c]})})},d.extend=function(a){return d.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},d.contains=function(a,b){if(!n){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}return a.indexOf(b)>-1},d.every=function(a,b,c){b||(b=d.identity);var f=!0;return null==a?f:m&&a.every===m?a.every(b,c):(d.each(a,function(a,d,g){return(f=f&&b.call(c,a,d,g))?void 0:e}),!!f)},d.indexOf=function(a,b){if(null==a)return-1;var c=0,d=a.length;if(n&&a.indexOf===n)return a.indexOf(b);for(;d>c;c++)if(a[c]===b)return c;return-1};var p=function(){};d.bind=function(a,b){var c,e;if(o&&a.bind===o)return o.apply(a,i.call(arguments,1));if(!d.isFunction(a))throw new TypeError;return c=i.call(arguments,2),e=function(){if(!(this instanceof e))return a.apply(b,c.concat(i.call(arguments)));p.prototype=a.prototype;var d=new p;p.prototype=null;var f=a.apply(d,c.concat(i.call(arguments)));return Object(f)===f?f:d}},d.get=function(a,b,c){if(c=d.isNone(c)?null:c,d.isNone(b)||!d.isString(b)||!a)return c;if(""===b)return a;var e=b.split("."),f=e.splice(0,1)[0];return a.hasOwnProperty(f)?d.get(a[f],e.join("."),c):c},d.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return!1}},d.isNone=function(a){return null===a||void 0===a},d.isString=function(a){return"[object String]"===j.call(a)},d.isNumber=function(a){return"[object Number]"===j.call(a)},d.isDate=function(a){return"[object Date]"===j.call(a)},d.isObject=function(a){return"[object Object]"===j.call(a)},d.isArray=function(a){return"[object Array]"===j.call(a)},d.isElement=function(a){return!d.isNone(a)&&!d.isNone(a.nodeType)&&1===a.nodeType},d.isEmptyObject=function(a){if(d.isObject(a)){for(var b in a)if(g.hasOwnProperty.call(a,b))return!1;return!0}return!1},d.bool=function(a){return d.isNone(a)?null:"true"===a||"1"===a||1===a||a===!0?!0:"false"===a||"0"===a||0===a||a===!1?!1:null},d.assert=function(a,b){if(!a)throw b||"Assertion Failed"},d.getUUID=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},d.getTimestamp=function(){var a=new Date;return a.getTime()},d.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},d.capitalize=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},d.camelCase=function(a){var b=a.split("-");return b.length>1&&(a=b[0],a+=d.map(b.slice(1),function(a){return a[0].toUpperCase()+a.substr(1)}).join("")),a},d.truncate=function(a,b){return a?(b=b?b:50,a.length<b?a:(a=a.substr(0,b-3),d.trim(a)+"...")):""},d.hash=function(a){for(var b=0,c=0,d=a.length;d>c;c++)b=31*b+a.charCodeAt(c)<<0;return(Math.pow(2,31)+b).toString()},d.rgbToHex=function(a,b,c){return"#"+((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},c.EMB_DEBUG===!0&&(window._=d),b.exports=d},{conf:"AqyHQT"}],conf:[function(a,b){b.exports=a("AqyHQT")},{}],AqyHQT:[function(a,b){!function(a){a.EMB_DEBUG=!1,a.EMB_HTTPS="https:"===window.location.protocol?!0:!1,a.EMB_ORIGIN=(a.EMB_HTTPS?"https":"http")+"://cdn.embedly.com",a.EMB_FRAME_SRC=a.EMB_ORIGIN+"/widgets/",a.EMB_SECURE_FRAME_SRC="https://cdn.embedly.com/widgets/",a.EMB_POST_MESSAGE=!!window.postMessage,a.EMB_PROGRESS=!0,a.EMB_APP_API="https://app.embed.ly",a.EMB_API_KEY="fd92ebbc52fc43fb98f69e50e7893c13";var b=window.location.pathname.split(".")[0].split("/");a.EMB_GROUP=b[b.length-1].toLowerCase(),a.PAGE_PROGRESS_DOMAINS=[]}("undefined"==typeof b?this.conf={}:b.exports)},{}],26:[function(a){var b=a("./common/receiver.js"),c=a("./common/browser.js"),d=a("./common/stats/base.js"),e=a("./common/users.js"),f=a("./common/utils.js"),g=a("./common/a.js"),h=a("./common/track.js"),i=a("./common/progress.js"),j=new g;j.on("xcomm.stats.access",function(a){var b,d=e.get(),g={access:!1,org:null,disabled:!1};null!==d&&("media"===a.group?b=d.orgByKey(a.key):"card"===a.group&&(b=d.orgByUrls(a.url,a.ref)),b&&(g.access=!0,g.org=b),null===b&&d.s&&(g.access=!0,g.s=!0)),g.disabled="1"===c.cookie.get("embly_d"),g=f.extend(a,g),j.notify("receiver.send","xcomm.stats.access",g)});var k=function(a){j.on(a,function(b){d.get("cards",b.url,{filter:b.filter,key:"internal",start:b.start,end:b.end,realtime:f.isNone(b.realtime)?!1:!0},function(b){j.notify("receiver.send",a,{results:b})})})};k("xcomm.stats.card"),k("xcomm.stats.card.realtime"),k("xcomm.stats.card.week");var l=function(a){j.on(a,function(b){d.get("media",b.url,{filter:b.filter,key:b.key,start:b.start,end:b.end,realtime:f.isNone(b.realtime)?!1:!0},function(b){j.notify("receiver.send",a,{results:b})})})};l("xcomm.stats.media"),l("xcomm.stats.media.realtime"),l("xcomm.stats.media.week"),j.on("xcomm.user.get",function(){var a=e.get(),b={s:!1,orgs:[]};a&&(b=a.data()),j.notify("receiver.send","xcomm.user.get",{user:b})}),j.on("xcomm.user.set",function(a){e.save({s:a.s,orgs:a.orgs});var b=e.get();j.notify("receiver.send","xcomm.user.set",{user:b.data()})}),j.on("xcomm.user.remove",function(){e.remove();var a=e.get();j.notify("receiver.send","xcomm.user.remove",{user:a})}),j.on("xcomm.stats.media.recommend",function(a){d.recommend(a,function(a){j.notify("receiver.send","xcomm.stats.media.recommend",{results:a})})}),j.on("xcomm.stats.card.recommend",function(a){d.recommend(a,function(a){j.notify("receiver.send","xcomm.stats.card.recommend",{results:a})})}),j.on("xcomm.page.progress",function(){i.page(j);j.on("page.progress.data",function(a){j.notify("track.event","page","progress",i.stringify(a.times))}),j.notify("receiver.send","xcomm.page.progress")}),b.connect(j),h.connect(j),h.configure({url:document.referrer},"page"),j.notify("receiver.send","xcomm.ready")},{"./common/a.js":1,"./common/browser.js":3,"./common/progress.js":9,"./common/receiver.js":10,"./common/stats/base.js":12,"./common/track.js":20,"./common/users.js":22,"./common/utils.js":23}]},{},[26]);</script>
</body></html>